"use strict";angular.module("ocean04App",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngCart.fulfilment","ui.bootstrap","GoogleMapsNative"]).config(["$routeProvider","$httpProvider",function(a,b){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/gifts",{templateUrl:"views/gifts.html",controller:"GiftsCtrl",controllerAs:"gifts"}).when("/how",{templateUrl:"views/how.html",controller:"HowCtrl",controllerAs:"how"}).when("/rocket04",{templateUrl:"views/store.html",controller:"storeCtrl",controllerAs:"store"}).when("/cart",{templateUrl:"views/cart.html",controller:"cartCtrl",controllerAs:"cart"}).when("/desc/:id",{templateUrl:"views/fulldesc.html",controller:"FulldescCtrl",controllerAs:"f"}).when("/gMap",{templateUrl:"views/gmap.html",controller:"GmapCtrl",controllerAs:"gMap"}).when("/contract",{templateUrl:"views/contract.html",controller:"ContractCtrl",controllerAs:"contract"}).when("/contacts",{templateUrl:"views/contacts.html",controller:"ContactsCtrl",controllerAs:"contacts"}).otherwise({redirectTo:"/"})}]).run(["$location",function(a){"rocket04.com"==window.location.host&&0==window.location.protocol&&(window.location.protocol="https"),$("#menuStick").slicknav({brand:'<a href="#/"><img src="https://rocket04.imgix.net/logo.svg?s=533089706d3998f2811d218fd2fe2fa5" alt=""></a>',label:"",closeOnClick:!0}),$(window).resize(function(){var a=document.body.clientWidth,b=(a-120)/2/a*100,c=b+"%";$(".slicknav_brand").css("left",c),$(".navbar-header").css("left",c)})}]).animation(".rocket-view",function(){return{enter:function(a,b){return a.css("display","none"),a.fadeIn(500,b),function(){a.stop()}},leave:function(a,b){return a.fadeOut(500,b),function(){a.stop()}}}}),angular.module("ocean04App").controller("MainCtrl",["$rootScope",function(a){$(document).scrollTop(0)}]),angular.module("ocean04App").controller("AboutCtrl",["$rootScope",function(a){$(document).scrollTop(0)}]),angular.module("ocean04App").controller("GiftsCtrl",["$rootScope","$scope","api",function(a,b,c){$(document).scrollTop(0);$(".giftCard");$("#phone").mask("+38(999)999-99-99"),b.formUser={},b.selectedGift,b.selectGift=function(a,c){b.selectedGift=a,b.formUser.order_details="Подарочный сертификат стоимостью: "+c.price},b.gifts=[{img:"https://rocket04.imgix.net/gifts_1.jpg?s=fa9dea2977649ce50e30185840863067",price:50,text:"Быстро. Вкусно. Надёжно. Идеальный вариант, если других вариантов нет.",id:1,popular:""},{img:"https://rocket04.imgix.net/gifts_2.jpg?s=77307f3ac2cd865f502625a63ad84970",id:2,price:100,text:"Целая неделя вкусных обедов и ужинов на двоих.",popular:""},{img:"https://rocket04.imgix.net/gifts_3.jpg?s=67d0cef4aafa8c934c57a971ee6f4e22",id:3,price:250,text:"Идеальные выходные без головной боли на двоих.",popular:"Популярное"},{img:"https://rocket04.imgix.net/gifts_4.jpg?s=bf19b02e7d7a5a76de7773444db6656f",id:4,price:500,text:"Целая неделя вкусных обедов и ужинов на двоих.",popular:""}],b.buyGift=function(){for(var a=[],d=0;d<b.formUser.phone.length;d++)")"!==b.formUser.phone[d]&&"("!==b.formUser.phone[d]&&"-"!==b.formUser.phone[d]&&a.push(b.formUser.phone[d]);b.formUser.phone=a.join(""),console.log(b.formUser),c.receipe.orders(b.formUser).then(function(a){console.log(a)},function(a){console.log(a)})}}]),angular.module("ocean04App").controller("HowCtrl",["$rootScope",function(a){$(document).scrollTop(0)}]),angular.module("ocean04App").controller("storeCtrl",["$scope","$rootScope","api","loader","ngCart","ngCartItem",function(a,b,c,d,e,f){$(document).scrollTop(0),b.itemDescription=!1,$(".slicknav_menu").show(),a.receipeLst1=[],a.recepie,a.spinner=!1,a.colourIncludes=[],this.getReceipesList=function(){d.notAllowed(),c.receipe.store().then(function(b){a.receipeLst1=b,d.allowed()},function(b){a.receipeLst1=[],d.allowed()})},a.includeColour=function(b){console.log(b);var c=$.inArray(b,a.colourIncludes);c>-1?a.colourIncludes.splice(c,1):a.colourIncludes.push(b)},a.colourFilter=function(b){return a.colourIncludes.length>0&&$.inArray(b.tag,a.colourIncludes)<0?void 0:a.receipeLst1},a.clearFilter=function(){a.colourIncludes=[],$('input[type="checkbox"]').prop("checked",!1).parent().css("background","white")},this.getInCartQuantity=function(a){var b=e.getItemById(a),c=b._quantity;return this.inCartQunatity=c,this.inCartQunatity},this.removeFromCart=function(a){var b=e.getItemById(a);if(1===b._quantity)e.removeItemById(a);else{if(!(b._quantity>1))return;b.setQuantity(-1,!0)}this.getInCartQuantity(a)},this.AddToCart=function(a,b,c,d,f){console.log(f);var g=e.getItemById(a),d=d;g._quantity>=1&&(d=g._quantity+1),e.addItem(a,b,c,d,f),this.getInCartQuantity(a)},$(window).scroll(function(){var a=$(".storeNav"),b=$(window).scrollTop();b>=80?a.addClass("fixed"):a.removeClass("fixed")}),this.getReceipesList()}]),angular.module("ocean04App").controller("cartCtrl",["$scope","$rootScope","ngCart","api","$timeout",function(a,b,c,d,e){$(document).scrollTop(0),$("#phone").mask("+38(999)999-99-99"),$(".slicknav_menu").show(),b.itemDescription=!1,a.formUser={},a.deliveryDate;var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"];a.checkShipping=function(){c.totalCost()>500?a.shipping=0:a.shipping=20},a.getDeliveryDate=function(){var b=["Вс","Пн","Вт","Ср","Чт","Пт","Сб"][(new Date).getDay()];switch(b){case"Пн":a.deliveryDate=new Date(+new Date+1728e5);break;case"Вт":a.deliveryDate=new Date(+new Date+864e5);break;case"Ср":a.deliveryDate=new Date(+new Date+3456e5);break;case"Чт":a.deliveryDate=new Date(+new Date+2592e5);break;case"Пт":a.deliveryDate=new Date(+new Date+1728e5);break;case"Сб":a.deliveryDate=new Date(+new Date+864e5);break;case"Вс":a.deliveryDate=new Date(+new Date+2592e5)}console.log(a.deliveryDate)},a.getDeliveryDate(),a.cartItems=c.getCart(),a.getCart=function(){a.cartTotal=c.totalCost()},a.removeItem=function(a){c.removeItemById(a)},a.countTotal=function(){a.checkShipping(),a.totalWithShipping=c.totalCost()+a.shipping},a.getCart(),a.checkShipping(),a.countTotal(),a.checkout=function(){a.formUser.total="Общая сумма заказа: "+(c.totalCost()+a.shipping);var b=[];c.getCart().items.forEach(function(a){b.push(a._name+" - "+a._quantity)}),a.formUser.order_details=b.join(", ");var g=new Date(a.deliveryDate),h=g.getDate()+" "+f[g.getMonth()];a.formUser.timegap=h+"|"+$("li.active>a")[0].innerText;for(var i=[],j=0;j<a.formUser.phone.length;j++)")"!==a.formUser.phone[j]&&"("!==a.formUser.phone[j]&&"-"!==a.formUser.phone[j]&&i.push(a.formUser.phone[j]);a.formUser.phone=i.join(""),d.receipe.orders(a.formUser).then(function(b){console.log(b),a.notification=!0,a.successOrder=!0,e(function(){a.successOrder=!1,a.notification=!1},9e3)},function(b){console.log(b),a.notification=!0,a.errorOrder=!0,e(function(){a.errorOrder=!1,a.notification=!1},9e3)})}}]),angular.module("ocean04App").service("api",["$http","$q","$window",function(a,b,c){a.defaults.useXDomain=!0;var d="https://rocket04.com/",e=function(c,e,f){return b(function(b,e){a({method:"GET",url:d+c,params:f}).success(function(a){for(var c=0;c<a.length;c++){var d=a[c].price.toString().split(".");a[c].price,a[c].newPrice={grand:d[0],cents:d[1]}}localStorage.setItem("items",JSON.stringify(a)),b(a)}).error(function(a,b,c,d){e&&e(a)})})},f=function(a,c){return b(function(b,e){var f=JSON.stringify(c);$.ajax({url:d+a,type:"post",data:f,headers:{"Content-Type":"application/json"},dataType:"json"}).success(function(a){console.log(a),b(a)}).error(function(a,b,c,d){e(a)})})};return{receipe:{store:function(){return e("get_recipes")},orders:function(a){return f("order",a)}}}}]),angular.module("ocean04App").controller("FulldescCtrl",["$scope","api","$rootScope","$routeParams","loader","ngCart",function(a,b,c,d,e,f){$(document).scrollTop(0),c.itemDescription=!0,$(".slicknav_menu").css("display","none !important"),a.receipe,this.getRecepieById=function(b){var c=JSON.parse(localStorage.getItem("items")).filter(function(a){return a.id==b?!0:void 0}),d=c[0],e=d.price.toString().split("."),f=d.nutrients.split("|"),g=d.subtitle.split("|");d.ingredients=d.ingredients.split("|"),d.portions=g[0],d.time=g[1],d.newPrice={grand:e[0],cents:e[1]},d.newNutrients={callories:f[0],proteins:f[1],fats:f[2],carbohydrates:f[3]},a.receipe=d},this.getInCartQuantity=function(a){var b=f.getItemById(a),c=b._quantity;return this.inCartQunatity=c,this.inCartQunatity},this.removeFromCart=function(a){var b=f.getItemById(a);if(1===b._quantity)f.removeItemById(a);else{if(!(b._quantity>1))return;b.setQuantity(-1,!0)}this.getInCartQuantity(a)},this.AddToCart=function(a,b,c,d,e){var g=f.getItemById(a),d=d;g._quantity>=1&&(d=g._quantity+1),f.addItem(a,b,c,d,e),this.getInCartQuantity(a)},this.getRecepieById(d.id)}]),angular.module("ocean04App").service("loader",["$http","$rootScope",function(a,b){return{allowed:function(){b.isLoading=!1},notAllowed:function(){b.isLoading=!0}}}]),angular.module("ocean04App").directive("rocketNavigation",["$rootScope",function(a){return{templateUrl:"static/build/views/directives/nav/nav.html",restrict:"E"}}]),angular.module("ocean04App").directive("rocketFooter",function(){return{templateUrl:"static/build/views/directives/footer/footer.html",restrict:"E"}}),angular.module("ocean04App").config([function(){}]).provider("$ngCart",function(){this.$get=function(){}}).run(["$rootScope","ngCart","ngCartItem","store",function(a,b,c,d){a.$on("ngCart:change",function(){b.$save()}),angular.isObject(d.get("cart"))?b.$restore(d.get("cart")):b.init()}]).service("ngCart",["$rootScope","ngCartItem","store",function(a,b,c){this.init=function(){this.$cart={shipping:null,taxRate:null,tax:null,items:[]}},this.addItem=function(c,d,e,f,g){var h=this.getItemById(c);if("object"==typeof h)h.setQuantity(f,!1);else{var i=new b(c,d,e,f,g);this.$cart.items.push(i),a.$broadcast("ngCart:itemAdded",i)}a.$broadcast("ngCart:change",{})},this.getItemById=function(a){var b=this.getCart().items,c=!1;return angular.forEach(b,function(b){b.getId()===a&&(c=b)}),c},this.setShipping=function(a){return this.$cart.shipping=a,this.getShipping()},this.getShipping=function(){return 0==this.getCart().items.length?0:this.getCart().shipping},this.setTaxRate=function(a){return this.$cart.taxRate=+parseFloat(a).toFixed(2),this.getTaxRate()},this.getTaxRate=function(){return this.$cart.taxRate},this.getTax=function(){return+parseFloat(this.getSubTotal()/100*this.getCart().taxRate).toFixed(2)},this.setCart=function(a){return this.$cart=a,this.getCart()},this.getCart=function(){return this.$cart},this.getItems=function(){return this.getCart().items},this.getTotalItems=function(){var a=0,b=this.getItems();return angular.forEach(b,function(b){a+=b.getQuantity()}),a},this.getTotalUniqueItems=function(){return this.getCart().items.length},this.getSubTotal=function(){var a=0;return angular.forEach(this.getCart().items,function(b){a+=b.getTotal()}),+parseFloat(a).toFixed(2)},this.totalCost=function(){return+parseFloat(this.getSubTotal()+this.getShipping()+this.getTax()).toFixed(2)},this.removeItem=function(b){this.$cart.items.splice(b,1),a.$broadcast("ngCart:itemRemoved",{}),a.$broadcast("ngCart:change",{})},this.removeItemById=function(b){var c=this.getCart();angular.forEach(c.items,function(a,d){a.getId()===b&&c.items.splice(d,1)}),this.setCart(c),a.$broadcast("ngCart:itemRemoved",{}),a.$broadcast("ngCart:change",{})},this.empty=function(){a.$broadcast("ngCart:change",{}),this.$cart.items=[],localStorage.removeItem("cart")},this.isEmpty=function(){return this.$cart.items.length>0?!1:!0},this.toObject=function(){if(0===this.getItems().length)return!1;var a=[];return angular.forEach(this.getItems(),function(b){a.push(b.toObject())}),{shipping:this.getShipping(),tax:this.getTax(),taxRate:this.getTaxRate(),subTotal:this.getSubTotal(),totalCost:this.totalCost(),items:a}},this.$restore=function(a){var c=this;c.init(),c.$cart.shipping=a.shipping,c.$cart.tax=a.tax,angular.forEach(a.items,function(a){c.$cart.items.push(new b(a._id,a._name,a._price,a._quantity,a._data))}),this.$save()},this.$save=function(){return c.set("cart",JSON.stringify(this.getCart()))}}]).factory("ngCartItem",["$rootScope","$log",function(a,b){var c=function(a,b,c,d,e){this.setId(a),this.setName(b),this.setPrice(c),this.setQuantity(d),this.setData(e)};return c.prototype.setId=function(a){a?this._id=a:b.error("An ID must be provided")},c.prototype.getId=function(){return this._id},c.prototype.setName=function(a){a?this._name=a:b.error("A name must be provided")},c.prototype.getName=function(){return this._name},c.prototype.setPrice=function(a){var c=parseFloat(a);c?0>=c?b.error("A price must be over 0"):this._price=c:b.error("A price must be provided")},c.prototype.getPrice=function(){return this._price},c.prototype.setQuantity=function(c,d){var e=parseInt(c);e%1===0?(d===!0?this._quantity+=e:this._quantity=e,this._quantity<1&&(this._quantity=1)):(this._quantity=1,b.info("Quantity must be an integer and was defaulted to 1")),a.itemQuantity=this._quantity,a.$broadcast("ngCart:change",{})},c.prototype.getQuantity=function(){return this._quantity},c.prototype.setData=function(a){a&&(this._data=a)},c.prototype.getData=function(){return this._data?this._data:void b.info("This item has no data")},c.prototype.getTotal=function(){return+parseFloat(this.getQuantity()*this.getPrice()).toFixed(2)},c.prototype.toObject=function(){return{id:this.getId(),name:this.getName(),price:this.getPrice(),quantity:this.getQuantity(),data:this.getData(),total:this.getTotal()}},c}]).service("store",["$window",function(a){return{get:function(b){if(a.localStorage[b]){var c=angular.fromJson(a.localStorage[b]);return JSON.parse(c)}return!1},set:function(b,c){return void 0===c?a.localStorage.removeItem(b):a.localStorage[b]=angular.toJson(c),a.localStorage[b]}}}]).controller("CartController",["$scope","ngCart",function(a,b){a.ngCart=b}]).value("version","1.0.0"),angular.module("ocean04App").controller("CartController",["$rootScope","$scope","ngCart",function(a,b,c){b.ngCart=c}]).directive("ngcartAddtocart",["ngCart",function(a){return{restrict:"E",controller:"CartController",scope:{id:"@",name:"@",quantity:"@",quantityMax:"@",price:"@",data:"="},transclude:!0,templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"static/build/views/directives/ngCart/addtocart.html":b.templateUrl},link:function(b,c,d){b.attrs=d,b.inCart=function(){return a.getItemById(d.id)},b.inCart()?b.q=a.getItemById(d.id).getQuantity():b.q=parseInt(b.quantity),b.qtyOpt=[];for(var e=1;e<=b.quantityMax;e++)b.qtyOpt.push(e)}}}]).directive("ngcartCart",[function(){return{restrict:"E",controller:"CartController",scope:{},templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"static/build/views/directives/ngCart/cart.html":b.templateUrl},link:function(a,b,c){}}}]).directive("ngcartSummary",[function(){return{restrict:"E",controller:"CartController",scope:{},transclude:!0,templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"static/build/views/directives/ngCart/summary.html":b.templateUrl}}}]).directive("ngcartCheckout",[function(){return{restrict:"E",controller:["$rootScope","$scope","ngCart","fulfilmentProvider",function(a,b,c,d){b.ngCart=c,b.checkout=function(){d.setService(b.service),d.setSettings(b.settings),d.checkout().success(function(b,c,d,e){a.$broadcast("ngCart:checkout_succeeded",b)}).error(function(b,c,d,e){a.$broadcast("ngCart:checkout_failed",{statusCode:c,error:b})})}}],scope:{service:"@",settings:"="},transclude:!0,templateUrl:function(a,b){return"undefined"==typeof b.templateUrl?"static/build/views/directives/ngCart/checkout.html":b.templateUrl}}}]),angular.module("ngCart.fulfilment",[]).service("fulfilmentProvider",["$injector",function(a){this._obj={service:void 0,settings:void 0},this.setService=function(a){this._obj.service=a},this.setSettings=function(a){this._obj.settings=a},this.checkout=function(){var b=a.get("ngCart.fulfilment."+this._obj.service);return b.checkout(this._obj.settings)}}]).service("ngCart.fulfilment.log",["$q","$log","ngCart",function(a,b,c){this.checkout=function(){var d=a.defer();return b.info(c.toObject()),d.resolve({cart:c.toObject()}),d.promise}}]).service("ngCart.fulfilment.http",["$http","ngCart",function(a,b){this.checkout=function(c){return a.post(c.url,{data:b.toObject(),options:c.options})}}]).service("ngCart.fulfilment.paypal",["$http","ngCart",function(a,b){}]),angular.module("ocean04App").directive("rocketNavstore",["$rootScope",function(a){return{templateUrl:"static/build/views/directives/navStore/navStore.html",restrict:"E"}}]),angular.module("ocean04App").controller("GmapCtrl",function(){$(document).scrollTop(0)}),angular.module("ocean04App").controller("ContractCtrl",function(){$(document).scrollTop(0)}),angular.module("ocean04App").controller("ContactsCtrl",function(){$(document).scrollTop(0)});